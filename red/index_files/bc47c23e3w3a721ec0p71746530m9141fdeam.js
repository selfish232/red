(()=>{"use strict";const e="product_added_to_cart";function t(){return window}let n,o,r,i,s,a,c,l,u,d,f="OFF";function p(e,n,o){const{jQuery:r}=t();r&&r(e).bind?r(e).bind(n,o):e.addEventListener&&e.addEventListener(n,o)}function h(e,t){"ON"===f&&console&&console.warn&&console.warn(`[pixel_shop_events_listener] Error in ${e}:  ${t.message}`)}function m(e){p(window,"load",(()=>{for(const t of document.forms)e(t)}))}function g(e,t,n){if(t.length!==n.length)throw Error("Payload body and response have different number of items");t.forEach(((t,o)=>{let r=1;try{r=parseInt(n[o].quantity,10)||1}catch(i){h("handleBulkItemCartAddResponse",i)}E(e,t,r)}))}function E(n,o,r){const i=((null===(c=null===(l=t())||void 0===l?void 0:l.ShopifyAnalytics)||void 0===c?void 0:c.meta)||{}).currency,s={id:String(o.id),image:{src:o.image},price:{amount:o.price/100,currencyCode:i},product:{id:String(o.product_id),title:o.title,vendor:o.vendor},sku:o.sku,title:o.variant_title},a={cost:{totalAmount:{amount:s.price.amount*r,currencyCode:i}},merchandise:s,quantity:r};var c,l;n(e,{cartLine:a})}function b(e){if(!e)return 1;try{return JSON.parse(e).quantity||1}catch(t){if(e instanceof FormData){if(e.has("quantity"))return Number(e.get("quantity"))}else{const t=e.split("&");for(const e of t){const t=e.split("=");if("quantity"===t[0])return Number(t[1])}}}return 1}class y{static handleXhrOpen(){}static handleXhrDone(e){try{const t=document.createElement("a");t.href=e.url;const n=t.pathname?t.pathname:e.url;y.ADD_TO_CART_REGEX.test(n)&&y.parsePayloadResponse(e,(t=>{const n=Object.keys(t);if(1===n.length&&"items"===n[0]){const n=t.items;let r;try{r=JSON.parse(e.body).items}catch(o){r=function(e,t){const n=new Array(t);for(let o=0;o<t;o++)n[o]={};for(const o of decodeURI(e).split("&")){const e=o.split("="),t=e[0].match(/items\[(\d+)\]\[(\w+)\].*/);if(t){const o=Number(t[1]),r=t[2];"quantity"===r?n[o].quantity=e[1]:"id"===r&&(n[o].id=e[1])}}return n}(e.body,n.length)}g(e.publish,n,r)}else E(e.publish,t,b(e.body))}))}catch(t){h("handleXhrDone",t)}}static parseBlobToJson(e,t){const n=new FileReader;n.addEventListener("loadend",(()=>{t(JSON.parse(String.fromCharCode(...new Uint8Array(n.result))))})),n.readAsArrayBuffer(e)}static parsePayloadResponse(e,t){e.xhr.response instanceof Blob?y.parseBlobToJson(e.xhr.response,t):e.xhr.responseText&&t(JSON.parse(e.xhr.responseText))}constructor(e,t,n,o,r){this.oldOnReadyStateChange=void 0,this.xhr=void 0,this.url=void 0,this.method=void 0,this.body=void 0,this.publish=void 0,this.xhr=e,this.url=t,this.method=n,this.body=o,this.publish=r}onReadyStateChange(){this.xhr.readyState===XMLHttpRequest.DONE&&y.handleXhrDone({method:this.method,url:this.url,body:this.body,xhr:this.xhr,publish:this.publish}),this.oldOnReadyStateChange&&this.oldOnReadyStateChange.call(this.xhr,new Event("oldOnReadyStateChange"))}}function w(n,o){!function(e,t){const n=e.prototype.open,o=e.prototype.send;e.prototype.open=function(e,t){this._url=t,this._method=e,n.apply(this,arguments)},e.prototype.send=function(e){if(!(e instanceof Document)){const n=new y(this,this._url,this._method,e||"",t);this.addEventListener?this.addEventListener("readystatechange",n.onReadyStateChange.bind(n),!1):(n.oldOnReadyStateChange=this.onreadystatechange,this.onreadystatechange=n.onReadyStateChange)}o.call(this,e)}}(XMLHttpRequest,n),function(e,t){const n=e.fetch;function o(e,n){e.clone().json().then((e=>{const o=n.items,r=e.items;return g(t,r,o),e})).catch(i)}function r(e,n){const o=b(n);e.clone().json().then((e=>E(t,e,o))).catch(i)}function i(e){h("handleFetchRequest",e)}"function"==typeof n&&(e.fetch=function(...e){return n.apply(this,Array.prototype.slice.call(e)).then((e=>{if(!e.ok)return e;const t=document.createElement("a");t.href=e.url;const n=t.pathname?t.pathname:e.url;try{if(y.ADD_TO_CART_REGEX.test(n)){try{const t=JSON.parse(arguments[1].body);if(Object.keys(t).includes("items"))return o(e,t),e}catch(s){i(s)}r(e,arguments[1].body)}}catch(s){i(s)}return e}))})}(t(),n),m((t=>{const r=t.getAttribute("action");r&&r.indexOf("/cart/add")>=0&&p(t,"submit",(t=>{!function(t,n,o){const r=n||window.event;if(r.defaultPrevented)return;const i=r.currentTarget||r.srcElement;if(i&&i instanceof Element&&(i.getAttribute("action")||i.getAttribute("href")))try{const n=function(e){let t;const n=e.querySelector('[name="id"]');return n instanceof HTMLSelectElement&&n.options?t=n.options[n.selectedIndex]:(n instanceof HTMLOptionElement||n instanceof HTMLInputElement)&&(t=n),t}(i);if(!n)return;const r=n.value,s=function(e){const t=e.querySelector('[name="quantity"]');return t instanceof HTMLInputElement?Number(t.value):1}(i),a=function(e,t){var n;let o;const r=null===(n=t.productVariants)||void 0===n?void 0:n.filter((t=>t.id===e));if(!r||!r.length)throw new Error("Product variant not found");return o={...r[0]},o}(r,o),c={cost:{totalAmount:{amount:a.price.amount*s,currencyCode:a.price.currencyCode}},merchandise:a,quantity:s};t(e,{cartLine:c})}catch(s){h("handleSubmitCartAdd",s)}}(n,t,o)}))}))}function C(e,t,n){var o;null!=n&&n.logLevel&&(o=n.logLevel,f=o),w(e,t),function(e,t){m((n=>{const o=n.querySelector('[name="previous_step"]');o&&o instanceof HTMLInputElement&&"payment_method"===o.value&&p(document.body,"submit",(n=>{!function(e,t,n){const o=t||window.event,r=o.target||o.srcElement;if(r&&r instanceof HTMLFormElement&&r.getAttribute("action")&&null!==r.getAttribute("data-payment-form"))try{const t=n.checkout;if(!t)throw new Error("Checkout data not found");e("payment_info_submitted",{checkout:t})}catch(i){h("handleSubmitToPaymentAdd",i)}}(e,n,t)}))}))}(e,t)}var A,_,v,T,R,P;y.ADD_TO_CART_REGEX=/^(?:\/[a-zA-Z]+(?:-[a-zA-Z]+)?)?\/cart\/add(?:\.js|\.json)?$/,function(e){e.TRACKING_ACCEPTED="trackingConsentAccepted",e.TRACKING_DECLINED="trackingConsentDeclined",e.FIRST_PARTY_MARKETING_ACCEPTED="firstPartyMarketingConsentAccepted",e.THIRD_PARTY_MARKETING_ACCEPTED="thirdPartyMarketingConsentAccepted",e.ANALYTICS_ACCEPTED="analyticsConsentAccepted",e.PREFERENCES_ACCEPTED="preferencesConsentAccepted",e.FIRST_PARTY_MARKETING_DECLINED="firstPartyMarketingConsentDeclined",e.THIRD_PARTY_MARKETING_DECLINED="thirdPartyMarketingConsentDeclined",e.ANALYTICS_DECLINED="analyticsConsentDeclined",e.PREFERENCES_DECLINED="preferencesConsentDeclined",e.CONSENT_COLLECTED="visitorConsentCollected"}(n||(n={})),(P=o||(o={})).V2_0="2.0",P.V2_1="2.1",function(e){e.ACCEPTED="yes",e.DECLINED="no",e.NO_INTERACTION="no_interaction",e.NO_VALUE=""}(r||(r={})),(R=i||(i={})).NO_VALUE="",R.ACCEPTED="1",R.DECLINED="0",(T=s||(s={})).GDPR="GDPR",T.CCPA="CCPA",T.NO_VALUE="",function(e){e.PREFERENCES="p",e.ANALYTICS="a",e.FIRST_PARTY_MARKETING="m",e.THIRD_PARTY_MARKETING="t"}(a||(a={})),(v=c||(c={})).CCPA_BLOCK_ALL="CCPA_BLOCK_ALL",v.GDPR="GDPR",v.GDPR_BLOCK_ALL="GDPR_BLOCK_ALL",v.CCPA="CCPA",(_=l||(l={})).MARKETING="m",_.ANALYTICS="a",_.PREFERENCES="p",_.GPC="g",_.SALE_OF_DATA="s",function(e){e.MARKETING="m",e.ANALYTICS="a",e.PREFERENCES="p",e.GPC="g",e.SALE_OF_DATA="s"}(u||(u={})),(A=d||(d={})).MARKETING="marketing",A.ANALYTICS="analytics",A.PREFERENCES="preferences",A.GPC="gpc",A.SALE_OF_DATA="sale_of_data";const I=["lim","v","con","reg"];let S={};function N(e){if(e in S)return S[e];const t=document.cookie?document.cookie.split("; "):[];S[e]=void 0;for(let n=0;n<t.length;n++){const[o,r]=t[n].split("=");if(e===decodeURIComponent(o)){S[e]=JSON.parse(decodeURIComponent(r));break}}return S[e]}function x(){S={}}function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(){const e=N("_tracking_consent");if(void 0!==e&&(t=e,[o.V2_0,o.V2_1].includes(t.v)&&function(e,t){const n=t.slice().sort();return e.length===t.length&&e.slice().sort().every(((e,t)=>e===n[t]))}(Object.keys(t).filter((e=>"region"!==e)),I)))return e;var t}function M(){try{let e=k();if(!e)return;return e.v===o.V2_0?function(e){const t=e.con||{};return{con:{CMP:{[u.MARKETING]:t.GDPR||i.NO_VALUE,[l.ANALYTICS]:t.GDPR||i.NO_VALUE,[l.PREFERENCES]:t.GDPR||i.NO_VALUE,[l.GPC]:i.NO_VALUE,[l.SALE_OF_DATA]:t.CCPA||i.NO_VALUE}},reg:e.reg,v:o.V2_1,lim:e.lim}}(e):e}catch(e){return}}function G(){return{m:K(u.MARKETING),a:K(u.ANALYTICS),p:K(u.PREFERENCES),s:K(u.SALE_OF_DATA),g:K(u.GPC)}}function j(){return G()[u.SALE_OF_DATA]}function U(e=null){return null===e&&(e=M()),void 0===e}function K(e){if(e==u.GPC)return pe.isGPCSignalPresent()?pe.isGPCOptOutPresent()?i.DECLINED:i.ACCEPTED:i.NO_VALUE;const t=M();if(!t)return i.NO_VALUE;const n=t.con.CMP;return n?n[e]:i.NO_VALUE}function Y(){return N("_cmp_a")}function B(e){const t=Y();if(!t)return!0;const n=t.purposes[e];return"boolean"!=typeof n||n}function V(){return B(a.PREFERENCES)}function F(){return B(a.ANALYTICS)}function $(){return B(a.FIRST_PARTY_MARKETING)}function q(){return B(a.THIRD_PARTY_MARKETING)}const H={"":[],GDPR:[c.GDPR,c.GDPR_BLOCK_ALL],CCPA:[c.CCPA_BLOCK_ALL,c.CCPA]};function z(e,t){document.dispatchEvent(new CustomEvent(e,{detail:t||{}}))}function W(e){!0===e[a.FIRST_PARTY_MARKETING]?z(n.FIRST_PARTY_MARKETING_ACCEPTED):!1===e[a.FIRST_PARTY_MARKETING]&&z(n.FIRST_PARTY_MARKETING_DECLINED),!0===e[a.THIRD_PARTY_MARKETING]?z(n.THIRD_PARTY_MARKETING_ACCEPTED):!1===e[a.THIRD_PARTY_MARKETING]&&z(n.THIRD_PARTY_MARKETING_DECLINED),!0===e[a.ANALYTICS]?z(n.ANALYTICS_ACCEPTED):!1===e[a.ANALYTICS]&&z(n.ANALYTICS_DECLINED),!0===e[a.PREFERENCES]?z(n.PREFERENCES_ACCEPTED):!1===e[a.PREFERENCES]&&z(n.PREFERENCES_DECLINED);const t=function(e){return{firstPartyMarketingAllowed:e[a.FIRST_PARTY_MARKETING],thirdPartyMarketingAllowed:e[a.THIRD_PARTY_MARKETING],analyticsAllowed:e[a.ANALYTICS],preferencesAllowed:e[a.PREFERENCES]}}(e);z(n.CONSENT_COLLECTED,t)}function X(e,t,o){const r=new XMLHttpRequest,i=JSON.stringify(e);r.open("POST","/set_tracking_consent.json",!0),r.setRequestHeader("Content-Type","application/json"),r.onreadystatechange=function(){if(4!==r.readyState)return;x();const i=function(e){try{return JSON.parse(e)}catch(t){return{error:"Unknown error"}}}(r.responseText);var s;0===(s=r.status)||200>=s&&s<400?(function(e,t){void 0!==e.consent?(!0===e.consent?z(n.TRACKING_ACCEPTED):z(n.TRACKING_DECLINED),t&&W({[a.PREFERENCES]:e.consent,[a.ANALYTICS]:e.consent,[a.FIRST_PARTY_MARKETING]:e.consent,[a.THIRD_PARTY_MARKETING]:e.consent})):void 0!==e.granular_consent&&W({[a.PREFERENCES]:V(),[a.ANALYTICS]:F(),[a.FIRST_PARTY_MARKETING]:$(),[a.THIRD_PARTY_MARKETING]:q()})}(e,o),t(null,i)):t(i)},r.send(i)}function J(){if(U())return r.NO_VALUE;const e=G();return e[l.MARKETING]===i.ACCEPTED&&e[l.ANALYTICS]===i.ACCEPTED?r.ACCEPTED:e[l.MARKETING]===i.DECLINED||e[l.ANALYTICS]===i.DECLINED?r.DECLINED:r.NO_INTERACTION}function Q(){const e=function(){const e=M();return U(e)?s.NO_VALUE:e.reg}();return e in s?e:s.NO_VALUE}function Z(){return function(){const e=M();return U(e)?{limit:[]}:{limit:e.lim}}()}function ee(e){return ae(c.GDPR_BLOCK_ALL)&&e?oe()?document.referrer:"":null}function te(e){return ae(c.GDPR_BLOCK_ALL)&&e?oe()?window.location.pathname+window.location.search:"/":null}function ne(){return"string"==typeof navigator.globalPrivacyControl?"1"===navigator.globalPrivacyControl:Boolean(navigator.globalPrivacyControl)}function oe(){if(""===document.referrer)return!0;const e=document.createElement("a");return e.href=document.referrer,window.location.hostname!=e.hostname}function re(){return ae(c.GDPR)||ae(c.GDPR_BLOCK_ALL)}function ie(){const e=Q();if(e===s.NO_VALUE)return!1;const t=Z();return 0!==t.limit.length&&t.limit.some((t=>function(e,t){return H[e].includes(t)}(e,t)))}function se(){return!!U()||function(){if(!re())return!0;const e=G();return e[l.MARKETING]===i.ACCEPTED&&e[l.ANALYTICS]===i.ACCEPTED||e[l.MARKETING]!==i.DECLINED&&e[l.ANALYTICS]!==i.DECLINED&&Q()!==s.GDPR}()}function ae(e){return Z().limit.includes(e)}function ce(){return Q()===s.CCPA&&!!ae(c.CCPA)&&ne()}function le(){return!ce()&&(!!U()||!1!==se()&&(ae(c.CCPA_BLOCK_ALL)?Q()!==s.CCPA:!ae(c.CCPA)||j()!==i.DECLINED))}function ue(){return ce()?r.DECLINED:(e=j(),U()?r.NO_VALUE:e===i.NO_VALUE?r.NO_INTERACTION:function(e){switch(e){case i.ACCEPTED:return r.ACCEPTED;case i.DECLINED:return r.DECLINED;default:return r.NO_VALUE}}(e));var e}function de(e){if(!re())return!0;const t=G();return t[e]===i.ACCEPTED||t[e]!==i.DECLINED&&Q()!==s.GDPR}function fe(){return function(){const e=k();switch(null==e?void 0:e.v){case"2.0":return o.V2_0;case"2.1":return o.V2_1;default:return}}()===o.V2_1}const pe={getTrackingConsent:J,setTrackingConsent:function(e,t){if(U()){const e="Shop is not configured to block privacy regulation in online store settings.";return console.warn(e),t({error:e})}if(function(e){if(fe()){if("boolean"!=typeof e&&"object"!=typeof e)throw TypeError("setTrackingConsent must be called with a boolean or object consent value");if("object"==typeof e){const t=Object.keys(e);if(0===t.length)throw TypeError("The submitted consent object is empty.");const n=[d.MARKETING,d.ANALYTICS,d.PREFERENCES,d.SALE_OF_DATA];for(const e of t)if(!n.includes(e))throw TypeError(`The submitted consent object should only contain the following keys: ${n.join(", ")}.`)}}else if("boolean"!=typeof e)throw TypeError("setTrackingConsent must be called with a boolean consent value")}(e),"function"!=typeof t)throw TypeError("setTrackingConsent must be called with a callback function");if("object"==typeof e){const n=ee(e.analytics),o=te(e.analytics);return X(D(D({granular_consent:e},null!==n&&{referrer:n}),null!==o&&{landing_page:o}),t,fe())}{const n=ee(e),o=te(e);return X(D(D({consent:e},null!==n&&{referrer:n}),null!==o&&{landing_page:o}),t,fe())}},userCanBeTracked:se,getRegulation:Q,isRegulationEnforced:ie,getShopPrefs:Z,shouldShowGDPRBanner:function(){return Q()===s.GDPR&&ie()&&J()===r.NO_INTERACTION},userDataCanBeSold:le,setCCPAConsent:function(e,t){if("boolean"!=typeof e)throw TypeError("setCCPAConsent must be called with a boolean consent value");if("function"!=typeof t)throw TypeError("setCCPAConsent must be called with a callback function");return X({ccpa_consent:e},t,fe())},getCCPAConsent:ue,shouldShowCCPABanner:function(){return Q()===s.CCPA&&Z().limit.includes(c.CCPA)&&ue()===r.NO_INTERACTION},haveAnalyticsConsent:function(){return fe()?F():de(l.ANALYTICS)},havePreferencesConsent:function(){return fe()?V():de(l.PREFERENCES)},haveFirstPartyMarketingConsent:function(){return fe()?$():de(l.MARKETING)},haveThirdPartyMarketingConsent:function(){return fe()?q():!!de(l.MARKETING)&&!!le()},getCCPAConsentValue:j,merchantEnforcingRegulationLimit:ae,isGPCSignalPresent:function(){return void 0!==navigator.globalPrivacyControl},isGPCOptOutPresent:ne,isValidGPCSignalOptOutPresent:ce,exposeBetaFunctionality:fe,shouldShowBanner:function(){return fe()&&function(){const e=Y();return!!e&&"boolean"==typeof e.display_banner&&e.display_banner}()&&K(u.ANALYTICS)===i.NO_VALUE&&K(u.MARKETING)===i.NO_VALUE&&K(u.PREFERENCES)===i.NO_VALUE},saleOfDataRegion:function(){return fe()&&function(){const e=Y();return e&&e.sale_of_data_region||!1}()}};function he(){return pe.userCanBeTracked()}const me="0.0.222",ge={test:"edge_test_click/1.0",load:"web_pixels_manager_load/2.0",init:"web_pixels_manager_init/3.0",register:"web_pixels_manager_pixel_register/3.0",subscriberEventEmit:"web_pixels_manager_subscriber_event_emit/3.0",eventPublish:"web_pixels_manager_event_publish/1.1",consentAccepted:"web_pixels_manager_consent_accepted/1.0"};function Ee(e,t){return{schemaId:ge[e],payload:t}}function be(e){return e.replace(/\/$/,"")}function ye(e){const t={};for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const o=n.replace(/[A-Z]/g,(e=>`_${e}`)).toLowerCase(),r=e[n];t[o]=null!==r&&"object"==typeof r?ye(r):r}return t}class we extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,we)}}const Ce=(e,t)=>{var n,o;if(null!=t&&null!==(n=t.options)&&void 0!==n&&n.sampleRate&&!function(e){if(e<=0||e>100)throw new Error("Invalid sampling percent");return 100*Math.random()<=e}(t.options.sampleRate))return;const r={severity:"error",context:"",unhandled:!0,...t};let i="";const s={lineNumber:"1",columnNumber:"1",method:r.context,file:"browser.js"};if(e.stackTrace||e.stack||e.description){i=e.stack.split("\n")[0];const t=e.stack.match(/([0-9]+):([0-9]+)/);if(t&&t.length>2&&(s.lineNumber=t[1],s.columnNumber=t[2],parseInt(s.lineNumber,10)>1e5))return}fetch("https://notify.bugsnag.com",{method:"POST",headers:{"Content-Type":"application/json","Bugsnag-Api-Key":"bcbc9f6762da195561967577c2d74ff8","Bugsnag-Payload-Version":"5"},body:JSON.stringify({payloadVersion:5,notifier:{name:"web-pixel-manager",version:me,url:"-"},events:[{exceptions:[{errorClass:i,message:i,stacktrace:[s],type:"browserjs"}],context:r.context,severity:r.severity,unhandled:r.unhandled,app:{version:me},metaData:{device:{userAgent:null===(o=self.navigator)||void 0===o?void 0:o.userAgent},request:{shopId:r.shopId,shopUrl:self.location.href,pixelId:r.pixelId,pixelType:r.pixelType,runtimeContext:r.runtimeContext},"Additional Notes":{initConfig:JSON.stringify(r.initConfig),notes:r.notes}}}]})}).catch((()=>{}))};let Ae="";function _e(e=""){Ae=be(e)}let ve=Te();function Te(e){return e||"global"}const Re=new Array;let Pe;function Ie(e,t=!1){const n={...e,metadata:{eventCreatedAtMs:xe()}};Re.push(n),t?Ne():void 0===Pe&&(Pe=setTimeout(Ne,500))}function Se(e,t,n=!1){Ie(Ee(e,t),n)}function Ne(){if(Pe=void 0,0===Re.length)return;const e=[...Re];Re.length=0,function(e){if(0===e.length)return!1;const t={metadata:{event_sent_at_ms:xe()},events:e.map((e=>({schema_id:e.schemaId,payload:ye(e.payload),metadata:{event_created_at_ms:e.metadata.eventCreatedAtMs}})))};!function(e){const t=`${{global:"https://monorail-edge.shopifysvc.com",wellKnown:`${Ae}/.well-known/shopify/monorail`,staging:"https://monorail-edge-staging.shopifycloud.com",test:"https://localhost"}[ve]}/unstable/produce_batch`;try{if(self.navigator.sendBeacon.bind(self.navigator)(t,e))return!0}catch(o){}const n=new XMLHttpRequest;try{n.open("POST",t,!0),n.setRequestHeader("Content-Type","text/plain"),n.send(e)}catch(r){Ce(r,{context:"utilities/monorail/sendRequest",unhandled:!1})}}(JSON.stringify(t))}(e)}function xe(){return(new Date).getTime()}class Le extends Set{constructor(e,t){if(super(),this.maxSize=void 0,this.keep=void 0,Number.isFinite(e)&&!Number.isInteger(e)||e<=0)throw new Error("Invalid maxSize specified");this.maxSize=e,this.keep=t}push(e){if("oldest"===this.keep)this.size<this.maxSize&&this.add(e);else if("newest"===this.keep&&(this.add(e),this.size>this.maxSize))for(const t of this)if(this.delete(t),this.size<=this.maxSize)break;return this}}const De={bufferSize:50,replayKeep:"oldest",enableSubscribeAll:!1,subscribeAllKey:"all_events"};class Oe{constructor(e=De){this.channelSubscribers=new Map,this.replayQueue=void 0,this.options=void 0,this.options=e,this.replayQueue=new Le(e.bufferSize,e.replayKeep)}publish(e,t,n={}){var o;if(this.options.enableSubscribeAll&&e===this.options.subscribeAllKey)throw new Error(`Cannot publish to ${String(e)}`);this.replayQueue.push({name:e,payload:t,options:n});const r=(e,n)=>n.apply({},[{...t}]);var i;return null===(o=this.channelSubscribers.get(e))||void 0===o||o.forEach(r),this.options.enableSubscribeAll&&(null===(i=this.channelSubscribers.get(this.options.subscribeAllKey))||void 0===i||i.forEach(r)),!0}subscribe(e,t,n={}){const o=this.channelSubscribers.get(e)||new Map;return this.channelSubscribers.set(e,o.set(t,n)),this.replayQueue.forEach((({name:n,payload:o})=>{(e===n||this.options.enableSubscribeAll&&e===this.options.subscribeAllKey)&&t.apply({},[{...o}])})),()=>o.delete(t)}}const ke=["checkout_completed","checkout_started","payment_info_submitted","collection_viewed","page_viewed","product_added_to_cart","product_viewed","product_variant_viewed","search_submitted"],Me=["all_events","all_standard_events","all_custom_events","checkout_completed","checkout_started","payment_info_submitted","collection_viewed","page_viewed","product_added_to_cart","product_viewed","product_variant_viewed","search_submitted"];function Ge(e){return ke.includes(e)}function je(e){return Me.includes(e)}function Ue(){const e=pe.getShopPrefs();return e.limit.includes(c.GDPR)?"gdpr":e.limit.includes(c.GDPR_BLOCK_ALL)?"gdpr_block_all":"unknown"}let Ke=!1;const Ye=new Set;function Be(e){const t=()=>{e(),document.removeEventListener(n.TRACKING_ACCEPTED,t)};document.addEventListener(n.TRACKING_ACCEPTED,t)}function Ve(){return/checkouts\/(.+)\/(thank_you|thank-you|post_purchase)$/.test(self.location.pathname)}const Fe=["[object String]","[object Number]","[object Boolean]","[object Undefined]","[object Null]"];function $e(e){let t=null;function n(e){return"[object Object]"===Object.prototype.toString.call(e)}return void 0===e||n(e)?{isValid:function e(o){if(Array.isArray(o))return o.every(e);if(n(o))return Object.keys(o).every((t=>e(o[t])));const r=Fe.includes(Object.prototype.toString.call(o));return r||(t=`${o} must be one of the following types: ${Fe.join(", ")}`),r}(e),error:t}:(t=`${e} must be an object`,{isValid:!1,error:t})}const qe={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let He;const ze=new Uint8Array(16);function We(){if(!He&&(He="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!He))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return He(ze)}const Xe=[];for(let wt=0;wt<256;++wt)Xe.push((wt+256).toString(16).slice(1));const Je=function(e,t,n){if(qe.randomUUID&&!t&&!e)return qe.randomUUID();const o=(e=e||{}).random||(e.rng||We)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=o[e];return t}return function(e,t=0){return(Xe[e[t+0]]+Xe[e[t+1]]+Xe[e[t+2]]+Xe[e[t+3]]+"-"+Xe[e[t+4]]+Xe[e[t+5]]+"-"+Xe[e[t+6]]+Xe[e[t+7]]+"-"+Xe[e[t+8]]+Xe[e[t+9]]+"-"+Xe[e[t+10]]+Xe[e[t+11]]+Xe[e[t+12]]+Xe[e[t+13]]+Xe[e[t+14]]+Xe[e[t+15]]).toLowerCase()}(o)};function Qe(){return{document:{location:{href:window.location.href,hash:window.location.hash,host:window.location.host,hostname:window.location.hostname,origin:window.location.origin,pathname:window.location.pathname,port:window.location.port,protocol:window.location.protocol,search:window.location.search},referrer:document.referrer,characterSet:document.characterSet,title:document.title},navigator:{language:navigator.language,cookieEnabled:navigator.cookieEnabled,languages:navigator.languages,userAgent:navigator.userAgent},window:{innerHeight:window.innerHeight,innerWidth:window.innerWidth,outerHeight:window.outerHeight,outerWidth:window.outerWidth,pageXOffset:window.pageXOffset,pageYOffset:window.pageYOffset,location:{href:window.location.href,hash:window.location.hash,host:window.location.host,hostname:window.location.hostname,origin:window.location.origin,pathname:window.location.pathname,port:window.location.port,protocol:window.location.protocol,search:window.location.search},origin:window.origin,screenX:window.screenX,screenY:window.screenY,scrollX:window.scrollX,scrollY:window.scrollY}}}function Ze(e){const t={};for(const o of e.split(/ *; */)){const e=o.split("=");try{t[decodeURIComponent(e[0])]=decodeURIComponent(e[1]||"")}catch(n){continue}}return t}const et=Symbol.for("RemoteUi::Retain"),tt=Symbol.for("RemoteUi::Release"),nt=Symbol.for("RemoteUi::RetainedBy");class ot{constructor(){this.memoryManaged=new Set}add(e){this.memoryManaged.add(e),e[nt].add(this),e[et]()}release(){for(const e of this.memoryManaged)e[nt].delete(this),e[tt]();this.memoryManaged.clear()}}function rt(e){return Boolean(e&&e[et]&&e[tt])}function it(e,{deep:t=!0}={}){const n=rt(e);if(n&&e[et](),t){if(Array.isArray(e))return e.reduce(((e,n)=>it(n,{deep:t})||e),n);if("object"==typeof e&&null!=e)return Object.keys(e).reduce(((n,o)=>it(e[o],{deep:t})||n),n)}return n}const st="_@f";function at(e){const t=new Map,n=new Map,o=new Map;return{encode:function o(r){if("object"==typeof r){if(null==r)return[r];if(r instanceof ArrayBuffer)return[r];const e=[];if(Array.isArray(r)){return[r.map((t=>{const[n,r=[]]=o(t);return e.push(...r),n})),e]}return[Object.keys(r).reduce(((t,n)=>{const[i,s=[]]=o(r[n]);return e.push(...s),{...t,[n]:i}}),{}),e]}if("function"==typeof r){if(t.has(r)){const e=t.get(r);return[{[st]:e}]}const o=e.uuid();return t.set(r,o),n.set(o,r),[{[st]:o}]}return[r]},decode:r,async call(e,t){const o=new ot,i=n.get(e);if(null==i)throw new Error("You attempted to call a function that was already released.");try{const e=rt(i)?[o,...i[nt]]:[o];return await i(...r(t,e))}finally{o.release()}},release(e){const o=n.get(e);o&&(n.delete(e),t.delete(o))},terminate(){t.clear(),n.clear(),o.clear()}};function r(t,n){if("object"==typeof t){if(null==t)return t;if(t instanceof ArrayBuffer)return t;if(Array.isArray(t))return t.map((e=>r(e,n)));if(st in t){const r=t["_@f"];if(o.has(r))return o.get(r);let i=0,s=!1;const a=()=>{i-=1,0===i&&(s=!0,o.delete(r),e.release(r))},c=()=>{i+=1},l=new Set(n),u=(...t)=>{if(s)throw new Error("You attempted to call a function that was already released.");if(!o.has(r))throw new Error("You attempted to call a function that was already revoked.");return e.call(r,t)};Object.defineProperties(u,{[tt]:{value:a,writable:!1},[et]:{value:c,writable:!1},[nt]:{value:l,writable:!1}});for(const e of l)e.add(u);return o.set(r,u),u}return Object.keys(t).reduce(((e,o)=>({...e,[o]:r(t[o],n)})),{})}return t}}function ct(){return`${lt()}-${lt()}-${lt()}-${lt()}`}function lt(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)}function ut(e,t,n,o,r,i=!1){let s={};try{s=t.configuration?JSON.parse(t.configuration):{}}catch(h){}return{analytics:{subscribe:(r,s,a)=>(i&&it(s),e.subscribe(r,s,{...a,pixelRuntimeConfig:t,shopId:n,surface:o}))},browser:{cookie:{get:async e=>{if(e){let t="";const n=document.cookie.split("; ");for(const o of n){const[n,r]=o.split("=");if(n===e){t=r;break}}return t}return document.cookie},set:async(e,t)=>{if(t){const n=`${e}=${t}`;document.cookie=n}else document.cookie=e;return document.cookie}},sendBeacon:async(e,t="")=>{if(e.includes(self.location.origin)&&!e.match(/\/\.well-known\/shopify\/monorail\/unstable\/produce_batch/))return!1;const n=new window.Blob([t],{type:"text/plain"});return window.navigator.sendBeacon(e,n)},localStorage:{setItem:async(e,t)=>window.localStorage.setItem(e,t),getItem:async e=>window.localStorage.getItem(e),key:async e=>window.localStorage.key(e),removeItem:async e=>window.localStorage.removeItem(e),clear:async()=>window.localStorage.clear(),length:async()=>window.localStorage.length},sessionStorage:{setItem:async(e,t)=>window.sessionStorage.setItem(e,t),getItem:async e=>window.sessionStorage.getItem(e),key:async e=>window.sessionStorage.key(e),removeItem:async e=>window.sessionStorage.removeItem(e),clear:async()=>window.sessionStorage.clear(),length:async()=>window.sessionStorage.length}},settings:s,init:(a=r,{context:Qe(),data:{customer:(p=null==a?void 0:a.customer,p?{id:null==p?void 0:p.id,email:null==p?void 0:p.email,phone:null==p?void 0:p.phone}:null),cart:(c=null==a?void 0:a.cart,c?{id:null==c?void 0:c.id,cost:{totalAmount:{amount:null==c||null===(l=c.cost)||void 0===l||null===(u=l.totalAmount)||void 0===u?void 0:u.amount,currencyCode:null==c||null===(d=c.cost)||void 0===d||null===(f=d.totalAmount)||void 0===f?void 0:f.currencyCode}},lines:null==c?void 0:c.lines,totalQuantity:null==c?void 0:c.totalQuantity}:null)}}),_pixelInfo:{...t,surface:o}};var a,c,l,u,d,f,p}let dt,ft;function pt({webPixelConfig:e,eventBus:t,shopId:n,storefrontBaseUrl:o,webPixelsExtensionBaseUrl:r,surface:i,initData:s,betas:a}){let c;const l="shopify-app-pixel"===e.id||"shopify-custom-pixel"===e.id?"shopify":e.id,u=[r,"/app","/services",`/${n}`,"/web-pixels-manager",`/${e.type.toLowerCase()}`,`/web-pixel-${l}`,`@${e.scriptVersion}.js`].join(""),d=a.isEnabled("web_pixels_use_hash_urls")?"@c47c23e3w3a721ec0p71746530m9141fdea":"";if(e.type===ft.App||e.runtimeContext===dt.Strict){const e=[be(o),"/web-pixels-manager",`@0.0.222${d}`,"/sandbox","/worker.modern.js"];o.match(/spin\.dev\/?/)&&e.push("?fast_storefront_renderer=1"),c=new Worker(e.join(""))}else{let{search:t}=window.location;o.match(/spin\.dev\/?/)&&(t=`${t}${t.length?"&":"?"}fast_storefront_renderer=1`);const n=[be(o),`/web-pixels-manager@0.0.222${d}`,"/sandbox",window.location.pathname,t].join("");c=function(e,{terminate:t=!0,targetOrigin:n="*"}={}){if("undefined"==typeof window)throw new Error("You can only run fromIframe() in a browser context, but no window was found.");const o=new WeakMap,r=new Promise((t=>{window.addEventListener("message",(n=>{n.source===e.contentWindow&&"remote-ui::ready"===n.data&&t()}))}));return{async postMessage(t,o){await r,e.contentWindow.postMessage(t,n,o)},addEventListener(t,n){const r=t=>{t.source===e.contentWindow&&n(t)};o.set(n,r),self.addEventListener(t,r)},removeEventListener(e,t){const n=o.get(t);null!=n&&(o.delete(t),self.removeEventListener(e,n))},terminate(){t&&e.remove()}}}(function({id:e,src:t,srcdoc:n,privileges:o}){const r=document.querySelector(`iframe#sandbox-${e}`);if(r&&"IFRAME"===r.tagName)return r;const i=document.createElement("iframe");if(t)i.setAttribute("src",t);else{if(!n){const e=new we("src or srcdoc must be provided");throw Ce(e,{context:"createIframe",unhandled:!1,severity:"warning"}),e}i.setAttribute("srcdoc",n)}if(i.setAttribute("id",`sandbox-${e}`),i.setAttribute("sandbox",o.join(" ")),i.setAttribute("tabIndex","-1"),i.setAttribute("aria-hidden","true"),!function(e){return"sandbox"in e}(i)){const e=new we("browser does not support the sandbox attribute on IFrames");throw Ce(e,{context:"createIframe",unhandled:!1,severity:"warning"}),e}return i.setAttribute("style","display:none; height:0; width:0; visibility: hidden;"),function(e){let t=document.querySelector("#WebPixelsManagerSandboxContainer");null==t&&(t=document.createElement("div"),t.setAttribute("id","WebPixelsManagerSandboxContainer"),document.body.appendChild(t)),t.appendChild(e)}(i),i}({id:`web-pixel-extension-${e.type}-${e.id}`,src:n,privileges:["allow-scripts","allow-forms"]}))}const f=function(e,{uuid:t=ct,createEncoder:n=at,callable:o}={}){let r=!1,i=e;const s=new Map,a=new Map,c=function(e,t){let n;if(null==t){if("function"!=typeof Proxy)throw new Error("You must pass an array of callable methods in environments without Proxies.");const t=new Map;n=new Proxy({},{get(n,o){if(t.has(o))return t.get(o);const r=e(o);return t.set(o,r),r}})}else{n={};for(const o of t)Object.defineProperty(n,o,{value:e(o),writable:!1,configurable:!0,enumerable:!0})}return n}(f,o),l=n({uuid:t,release(e){u(3,[e])},call(e,n,o){const r=t(),i=p(r,o),[s,a]=l.encode(n);return u(5,[r,e,s],a),i}});return i.addEventListener("message",d),{call:c,replace(e){const t=i;i=e,t.removeEventListener("message",d),e.addEventListener("message",d)},expose(e){for(const t of Object.keys(e)){const n=e[t];"function"==typeof n?s.set(t,n):s.delete(t)}},callable(...e){if(null!=o)for(const t of e)Object.defineProperty(c,t,{value:f(t),writable:!1,configurable:!0,enumerable:!0})},terminate(){u(2,void 0),h(),i.terminate&&i.terminate()}};function u(e,t,n){r||i.postMessage(t?[e,t]:[e],n)}async function d(e){const{data:t}=e;if(null!=t&&Array.isArray(t))switch(t[0]){case 2:h();break;case 0:{const e=new ot,[o,r,i]=t[1],a=s.get(r);try{if(null==a)throw new Error(`No '${r}' method is exposed on this endpoint`);const[t,n]=l.encode(await a(...l.decode(i,[e])));u(1,[o,void 0,t],n)}catch(n){const{name:e,message:t,stack:r}=n;throw u(1,[o,{name:e,message:t,stack:r}]),n}finally{e.release()}break}case 1:{const[e]=t[1];a.get(e)(...t[1]),a.delete(e);break}case 3:{const[e]=t[1];l.release(e);break}case 6:{const[e]=t[1];a.get(e)(...t[1]),a.delete(e);break}case 5:{const[e,o,r]=t[1];try{const t=await l.call(o,r),[n,i]=l.encode(t);u(6,[e,void 0,n],i)}catch(n){const{name:t,message:o,stack:r}=n;throw u(6,[e,{name:t,message:o,stack:r}]),n}break}}}function f(e){return(...n)=>{if(r)return Promise.reject(new Error("You attempted to call a function on a terminated web worker."));if("string"!=typeof e&&"number"!=typeof e)return Promise.reject(new Error(`Canâ€™t call a symbol method on a remote endpoint: ${e.toString()}`));const o=t(),i=p(o),[s,a]=l.encode(n);return u(0,[o,e,s],a),i}}function p(e,t){return new Promise(((n,o)=>{a.set(e,((e,r,i)=>{if(null==r)n(i&&l.decode(i,t));else{const e=new Error;Object.assign(e,r),o(e)}}))}))}function h(){var e;r=!0,s.clear(),a.clear(),null===(e=l.terminate)||void 0===e||e.call(l),i.removeEventListener("message",d)}}(c,{callable:["initialize","initWebPixelsAwaitingConsent"]}),p=ut(t,e,n,i,s,!0),h={cookieRestrictedDomains:async()=>function(){const e=[];return self.location.hostname.split(".").reverse().reduce(((t,n)=>{const o=""===t?n:`${n}.${t}`;return r=o,document.cookie=`wpm-domain-test=1; path=/; domain=${r}`,document.cookie.split(";").find((e=>e.includes("wpm-domain-test")))||e.push(o),function(e){document.cookie=`wpm-domain-test=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; domain=${e}`}(o),o;var r}),""),e}(),userCanBeTracked:async()=>he(),self:{origin:{get:async()=>self.origin}},document:{referrer:{get:async()=>document.referrer}},monorail:{register:async({status:t,errorMsg:o})=>{const r=ht(e);Se("register",{version:me,pageUrl:self.location.href,shopId:n,surface:i,pixelId:e.id,pixelAppId:r,pixelSource:e.type,pixelRuntimeContext:e.runtimeContext,pixelScriptVersion:e.scriptVersion,pixelConfiguration:null==e?void 0:e.configuration,pixelEventSchemaVersion:e.eventPayloadVersion,status:t,errorMsg:o})}}};f.expose({pixelRuntimeAPI:()=>p,sandboxInternalAPI:()=>h});const m=self.document.title;return f.call.initialize(m,u,e),Be((()=>{f.call.initWebPixelsAwaitingConsent()})),{config:e,endpoint:f}}function ht(e){return e.type===ft.Custom?"-1":e.apiClientId?`${e.apiClientId}`:void 0}!function(e){e.Strict="STRICT",e.Lax="LAX"}(dt||(dt={})),function(e){e.App="APP",e.Custom="CUSTOM"}(ft||(ft={}));const mt="all_standard_events",gt="all_custom_events";function Et(e){const t=new Oe({bufferSize:Number.POSITIVE_INFINITY,replayKeep:"oldest",enableSubscribeAll:!0,subscribeAllKey:mt}),n=new Oe({bufferSize:1e3,replayKeep:"oldest",enableSubscribeAll:!0,subscribeAllKey:gt}),o=(Be((function(){x(),Ye.forEach((e=>{Ye.delete(e),e()}))})),{gate(e,t={runOnAccept:!0}){he()?e():t.runOnAccept&&Ye.add(e)}});e.initData;let r=!1;return{publish(n,o,i){var s,a,c;if("string"!=typeof n)throw new Error("Expected event name to be a string, but got "+typeof n);if(!Ge(n))return!1;"checkout_completed"===n&&Ve()&&document.cookie.indexOf("loggedConversion2=1");const l=$e(o);if(!l.isValid)return console.error(l.error),!1;const u=function(e,t,n){return{id:Je(),clientId:Ze(document.cookie)._shopify_y,timestamp:(new Date).toISOString(),name:e,context:Qe(),data:{...n||{}}}}(n,0,o);return Se("eventPublish",{version:me,pageUrl:self.location.href,shopId:e.shopId,surface:e.surface||"unknown",eventName:u.name,eventType:"standard",extensionId:null==i||null===(s=i.extension)||void 0===s?void 0:s.extensionId,extensionAppId:null==i||null===(a=i.extension)||void 0===a?void 0:a.appId,extensionType:null==i||null===(c=i.extension)||void 0===c?void 0:c.type,userCanBeTracked:he().toString(),shopPrefs:Ue()}),function(e){"checkout_completed"===e&&Ve()}(n),r||he()||(r=!0,d=e.shopId,f=e.surface||"unknown",Ye.add((()=>function(e,t){Ke||(Ke=!0,Se("consentAccepted",{version:me,shopId:e,surface:t,shopPrefs:Ue()}))}(d,f)))),t.publish(n,u);var d,f},publishCustomEvent(t,o,r){var i,s,a;if("string"!=typeof t)throw new Error("Expected event name to be a string, but got "+typeof t);if(Ge(t)||je(t))return!1;const c=$e(o);if(!c.isValid)return console.error(c.error),!1;const l=function(e,t,n=null){return{id:Je(),clientId:Ze(document.cookie)._shopify_y,timestamp:(new Date).toISOString(),name:e,context:Qe(),customData:n}}(t,0,o);return Se("eventPublish",{version:me,pageUrl:self.location.href,shopId:e.shopId,surface:e.surface||"unknown",eventName:l.name,eventType:"custom",extensionId:null==r||null===(i=r.extension)||void 0===i?void 0:i.extensionId,extensionAppId:null==r||null===(s=r.extension)||void 0===s?void 0:s.appId,extensionType:null==r||null===(a=r.extension)||void 0===a?void 0:a.type}),n.publish(t,l)},subscribe(e,r,i={}){const s=e=>{o.gate((()=>{var t;const n=i.schemaVersion||i.pixelRuntimeConfig.eventPayloadVersion;r(e),Se("subscriberEventEmit",{version:me,pageUrl:self.location.href,shopId:i.shopId,surface:i.surface,pixelId:i.pixelRuntimeConfig.id,pixelAppId:ht(i.pixelRuntimeConfig),pixelSource:i.pixelRuntimeConfig.type,pixelRuntimeContext:i.pixelRuntimeConfig.runtimeContext,pixelScriptVersion:i.pixelRuntimeConfig.scriptVersion,pixelConfiguration:null===(t=i.pixelRuntimeConfig)||void 0===t?void 0:t.configuration,pixelEventSchemaVersion:n,eventName:e.name,eventType:Ge(e.name)?"standard":"custom"})}))};if("all_events"===e){const e=t.subscribe(mt,s,i),o=n.subscribe(gt,s,i);return()=>e()&&o()}return e===gt?n.subscribe(gt,s,i):e===mt||je(e)?t.subscribe(e,s,i):n.subscribe(e,s,i)}}}function bt(e){try{return new URL(e),!0}catch(t){return function(e){const t=new RegExp("^(https?:\\/\\/)((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)*[a-z]{1,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return Boolean(t.test(e))}(e)}}const yt=function(){const e=Ee("load",{version:me,pageUrl:self.location.href,status:"loading"});try{const t=new Map;return e.payload.status="loaded",Ie(e),{init(e){const{shopId:n,cdnBaseUrl:o,webPixelsConfigList:r,surface:i="unknown",initData:s,enabledBetaFlags:a}=e||{},c=self.location.origin;_e(c);const l=function(e){const t=new Set(e);return{isEnabled:function(e){return t.has(e)}}}(a);l.isEnabled("web_pixels_use_shop_domain_monorail_endpoint")&&(ve=Te("wellKnown"));const u=Et(e),d=e.webPixelsExtensionBaseUrl||e.webPixelExtensionBaseUrl,f={severity:"warning",context:"createWebPixelsManager/init",unhandled:!1,shopId:n,initConfig:e},p=Ee("init",{version:me,pageUrl:self.location.href,shopId:n,surface:i,status:"initializing",userCanBeTracked:he().toString()}),h={publish:()=>!1,publishCustomEvent:()=>!1};try{if(self.Shopify&&!0===self.Shopify.designMode)return self.console&&console.log("[WebPixelsManager] Prevented from executing in the Theme Editor"),h;if(self.self!==self.top){const e=new we("WebPixelsManager: browser library is being run in a sandbox");throw Ce(e,f),e}if(!n){const e=new we("WebPixelsManager: shopId is required");throw Ce(e,f),e}if(!c){const e=new we("WebPixelsManager: storefrontBaseUrl is required");throw Ce(e,f),e}if(!bt(c)){const e=new we(`WebPixelsManager: storefrontBaseUrl is not a valid absolute URL: ${c}`);throw Ce(e,f),e}if(!d){const e=new we("WebPixelsManager: webPixelsExtensionBaseUrl is required");throw Ce(e,f),e}if(!bt(d)){const e=new we(`WebPixelsManager: webPixelsExtensionBaseUrl is not a valid absolute URL: ${d}`);throw Ce(e,f),e}if(!o){const e=new we("WebPixelsManager: cdnBaseUrl is required");throw Ce(e,f),e}if(!bt(o)){const e=new we(`WebPixelsManager: cdnBaseUrl is not a valid absolute URL: ${o}`);throw Ce(e,f),e}return r.forEach((e=>{try{e.id=String(e.id);const a=(r=e.id,`${e.type.toLowerCase()}/${r}`);if(!t.has(a)&&function(e){const t={eventPayloadVersion:"string",id:"string",runtimeContext:"string",scriptVersion:"string",type:"string"};return e.type===ft.App&&(t.configuration="string"),Object.keys(e).filter((n=>Object.prototype.hasOwnProperty.call(t,n)&&typeof e[n]===t[n])).length===Object.keys(t).length}(e)){const r=pt({webPixelConfig:e,eventBus:u,shopId:n,storefrontBaseUrl:c,webPixelsExtensionBaseUrl:d,cdnBaseUrl:o,surface:i,initData:s,betas:l});t.set(a,r)}else console.warn("Web Pixel config is invalid or already configured")}catch(a){a instanceof we||Ce(a,{context:"createWebPixelsManager"}),self.console&&console.error(a)}var r})),"checkout-one"!==i&&C(u.publish,s),p.payload.status="initialized",Ie(p),{publish:(e,t,n={})=>u.publish(e,t),publishCustomEvent:(e,t,n={})=>u.publishCustomEvent(e,t)}}catch(m){return m instanceof we||Ce(m,{context:"init",shopId:n,initConfig:e}),self.console&&console.error(m),p.payload.status="failed",p.payload.errorMsg=null==m?void 0:m.message,Ie(p),h}}}}catch(t){return t instanceof we||Ce(t,{context:"createWebPixelsManager"}),self.console&&console.error(t),e.payload.status="failed",e.payload.errorMsg=null==t?void 0:t.message,Ie(e,!0),{}}}();self.webPixelsManager=yt})();